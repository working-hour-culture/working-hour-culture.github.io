<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>24-Hour Working Activities</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.54.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.54.0/mapbox-gl.css' rel='stylesheet' />
    <!--Play and Pause Buttons and Weekday and Weekend Buttons--> 
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"></script>
    <!-- Chart-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
        
        /* Map-overlay */
         .map-overlay {
            font-family: 'Montserrat';
            position: absolute;
            width: 470px;
            top: 0;
            left: 0;
            padding: 10px;
        }
        
        /* Time Layout */
        #time {
            display: inline-block;
            padding: 10px;
        }
        .map-overlay-time {
            background-color: transparent;
            position: absolute;
            top: 85px;
            left: 10px;
            border-radius: 5px;
        }
        /* Time Slider */
        .map-overlay-slider {
            background-color: transparent;
            position: absolute;
            top: 140px;
            left: 15px;
        } 
        .map-overlay-slider-inner {
            display: inline-block;
            background-color: transparent;
            position: absolute; 
            width: 280px;
        }
        
        /* Play Pause and '+' '-' Button */
        .map-overlay-play {
            background-color: transparent;
            position: absolute;
            top: 140px;
            left: 300px;
        }
        .map-overlay-play-inner {
            display: inline-block;
            background-color: transparent;
            left: 7px;
            position: absolute; 
            width: 300px;
            top: 0px;
        }
        
        /* Weekday and Weedend Button */
        #menu {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 15px;
            top: 190px;
            padding: 10px;
            opacity: 0.6;
        }
        #menu a {
            color: white;
            display: block;
            margin: 0px auto;
            padding: 0;
            padding: 10px;
            text-decoration: none;
            border-bottom: 1px solid rgba(0,0,0,0.25);
        }
        .map-overlay-menu top {
            position: absolute;
            width: 100%;
            height: 20px;
            top: 10px; 
        }
        .map-overlay-menu inner {
            display: inline-block;
            position: absolute;
        }
        /* Weekday and Weedend Button - Current layer */
        #menu a[id = 'Weekday'].active {
            color: white;
            background: #3198ff;
            opacity: 1;
            border-bottom-left-radius: 3px;
            border-bottom-right-radius: 3px;
        }
        #menu a[id = 'Weekend'].active {
            color: white;
            background: #3198ff;
            opacity: 1;
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
        }
        /* Weekday and Weedend Button - Mouse Hover */
        #menu a[id = 'Weekday']:hover {
            color: white;
            background: #3198ff;
            opacity: 1;
            border-bottom-left-radius: 3px;
            border-bottom-right-radius: 3px;
        }
        #menu a[id = 'Weekend']:hover {
            color: white;
            background: #3198ff;
            opacity: 1;
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
        }
        /* Weekday and Weedend Button - Close the layer */
        #menu a[id = 'Weekday'].active:hover {
            color: white;
            background: #7f7f7f;
            opacity: 1;
            border-bottom-left-radius: 3px;
            border-bottom-right-radius: 3px;
        }
        #menu a[id = 'Weekend'].active:hover {
            color: white;
            background: #7f7f7f;
            opacity: 1;
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
        }
        
        /* Slider */
        .range-slider {
            color: black;
            opacity: 0.6;
            margin-bottom: 40px;
        }
        .backward {
            background-color: black;
            opacity: 0.6;
        }
        .backward:hover {
            background-color: #3198ff;
        }
        .forward {
            background-color: black;
            opacity: 0.6;
        }
        .forward:hover {
            background-color: #3198ff;
        }
        .play {
            background-color: black;
            opacity: 0.6;
        }
        .play:hover {
            background-color: #3198ff;
        }
        .stop {
            background-color: black;
            opacity: 0.6;
        }
        .stop:hover {
            background-color: #3198ff;
        }
        
        /* Text */
        /* Text - Heading and Weekday and Weedend Button */
        h1 {
            font-family: 'Montserrat';
            font-size: 17px;
            color: white;
            font-weight: normal;
        }
        /* Text - Time */
        h2 {
            font-family: 'Montserrat';
            font-size: 30px;
            color: white;
            text-shadow: 5px 5px 10px #0e0c43;
        }
        /* Text - Pop up */
        .mapboxgl-map {
            font-family: 'Montserrat';
            font-size: 13px;
            color: black;
            font-weight: bold;
        }
        /* Text - Other */
        h3 {
            font-family: 'Montserrat';
            font-size: 16px;
            color: white;
            font-weight: normal;
            margin: 0;
        }
        /* Style of text with links */
        .flyto {
            color: #34AED1;
            font-weight: bold;
        }
	    
        /* Range slider layout */
	/* Reference: https://github.com/london-rhythms/london-rhythms.github.io */
        .range-slider {
            -webkit-appearance: none; /* For custom style slider */
            width: 100%; /* Specific width is required for Firefox. */
            background: transparent; /* Otherwise white in Chrome */
        }
        .range-slider ::-ms-track {
            width: 100%;
            cursor: pointer;
            background: transparent; 
            border-color: transparent;
            color: transparent;
        }
        /* Special styling for WebKit/Blink */
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            border: 3px solid white;
            height: 29px;
            width: 15px;
            border-radius: 2px;
            background: black;
            opacity: 1;
            cursor: pointer;
            margin-top: -5px;
        }
        /* For Firefox */
        .range-slider::-moz-range-thumb {
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            border: 3px solid white;
            height: 29px;
            width: 15px;
            border-radius: 2px;
            background: black;
            opacity: 1; 
            cursor: pointer;
        }
        /* For IE */
        .range-slider::-ms-thumb {
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            border: 3px solid white;
            height: 29px;
            width: 32px;
            border-radius: 2px;
            background: black;
            opacity: 1;
            cursor: pointer;
        }
        /* Custom style slider */
        .range-slider::-webkit-slider-runnable-track {
            opacity: 1;
            width: 100%;
            height: 21px;
            cursor: pointer;
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            background: black;
            opacity: 0.9;
            border-radius: 1.3px;
            border: 0.2px solid white;
        }
        /* Change % of width so slider value is in de middle */
        .range-slider::-moz-range-track {
            opacity: 1;
            width: 100%;
            height: 20px;
            cursor: pointer;
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            background: black;
            border-radius: 1.3px;
            border: 0.2px solid white;
        }
        .range-slider::-ms-track {
            opacity: 1;
            width: 100%;
            height: 20px;
            cursor: pointer;
            background: black;
            border-width: 16px 0;
            color: transparent;
        }
        .range-slider::-ms-fill-lower {
            background: black;
            border: 0.2px solid #010101;
            border-radius: 2.6px;
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
        }
        .range-slider::-ms-fill-upper {
            background: black;
            border: 0.2px solid #010101;
            border-radius: 2.6px;
            box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
        }
	
        /* The style of "fly to" function */
        #features {
            position: absolute;
            top: 10px;
            right: 65px;
            width: 320px;
            height: 190px;
            background-color: black;
            color: white;
            opacity: 0.7;
            padding: 10px;
            display: block;
            border-radius: 5px;
            font-family: 'Montserrat', sans-serif;
            font-size: 12px;
            overflow-y: scroll;
        }
        /* The layout of text in features */
        section {
            padding:0;
            line-height: 19px;
            border-bottom: 1px solid #ddd;
            font-size: 13px;
            color: white;
        }
        section: last-child {
            border-bottom: none;
            margin-bottom: 20px;
        }
        
        /* Graph Show and Hide Button */
	/* Reference: https://github.com/london-rhythms/london-rhythms.github.io */
        #button1 {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 10px;
            bottom: 300px;
            padding: 10px;
            opacity: 0.6;
        }
        #button1:hover {
            font-size: 1vw;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
            cursor: pointer;
        }
        #button2 {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 10px;
            bottom: 250px;
            padding: 10px;
            opacity: 0.6;
        }
        #button2:hover {
            font-size: 1vw;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
            cursor: pointer;
        }
        #button3 {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 10px;
            bottom: 200px;
            padding: 10px;
            opacity: 0.6;
        }
        #button3:hover {
            font-size: 1vw;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
            cursor: pointer;
        }
        #button4 {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 10px;
            bottom: 150px;
            padding: 10px;
            opacity: 0.6;
        }
        #button4:hover {
            font-size: 1vw;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
            cursor: pointer;
        }
        #button5 {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 10px;
            bottom: 100px;
            padding: 10px;
            opacity: 0.6;
        }
        #button5:hover {
            font-size: 1vw;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
            cursor: pointer;
        }
        #button6 {
            background: #202020;
            border-radius: 10px;
            border: 2px solid #606060;
            color: white;
            font-family: "Montserrat";
            font-size: 0.9vw;
            position: absolute;
            left: 10px;
            bottom: 50px;
            padding: 10px;
            opacity: 0.6;
        }
        #button6:hover {
            font-size: 1vw;
            box-shadow: 0 12px 16px 0 rgba(0, 0, 0, 0.24), 0 17px 50px 0 rgba(0, 0, 0, 0.19);
            cursor: pointer;
        }
        
        /* Graph */
        #graph1 {
            position: absolute;
            bottom: 50px;
            right: 10px;
            width: 400px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            color: white;
            border-radius: 5px;
            display: none;
        }
        #graph2 {
            position: absolute;
            bottom: 50px;
            right: 10px;
            width: 400px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            color: white;
            border-radius: 5px;
            display: none;
        }
        #graph3 {
            position: absolute;
            bottom: 50px;
            right: 10px;
            width: 400px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            color: white;
            border-radius: 5px;
            display: none;
        }
        #graph4 {
            position: absolute;
            bottom: 50px;
            right: 10px;
            width: 400px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            color: white;
            border-radius: 5px;
            display: none;
        }
        #graph5 {
            position: absolute;
            bottom: 50px;
            right: 10px;
            width: 400px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            color: white;
            border-radius: 5px;
            display: none;
        }
        #graph6 {
            position: absolute;
            bottom: 50px;
            right: 10px;
            width: 400px;
            text-align: center;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            color: white;
            border-radius: 5px;
            display: none;
        }
        #linechart {
            width: 400px;
        }
    </style>
</head>
<body>
    <!--Map-->
    <div id="map"></div>
    
    <!--Time-->
    <h2><div class = 'map-overlay-time'><span id="time">0:00</span></div></h2>
    
    <!--Slider-->
    <div class='map-overlay-slider top'>
        <div class='map-overlay-slider-inner'>
            <label id='input2'></label>
            <input id = "input" type="range" class="range-slider" step="1" value="0" min="0" max="23"/>
            <div id="output"></div>
        </div>
    </div>
    
    <!--Play Pause and '+' '-' Button-->
    <div class='map-overlay-play top'>
        <div class='map-overlay-play-inner'>
            <button id="backward" class = "backward"><h3>-</h3></button>
            <button id="forward" class = "forward"><h3>+</h3></button>
            <button id="play" class = "play"><h3>Play</h3></button>
            <button id="stop" class = "stop "><h3>Pause</h3></button>
        </div>
    </div> 
    
    <!--Weekday and Weedend Button-->
    <div class='map-overlay-menu top'><div class='map-overlay-menu inner'><h1><nav id="menu"></nav></h1></div></div>
    
    <!--"Fly to" Function-->
    <div id="features">
        <section>
            <h3><a href="#" class="flyto" id="UK">UK</a></h3>
            <p>Overall, the number of office check-ins on weekdays is far beyond on weekends.  The highest number of check-ins is on 8 am on weekdays and 10 am on weekends. After that time, the number of people is gradually decreased. In addition, before 5 am and after 8 pm, there are fewer people in the office. The trend is even more pronounced in <a href="#" class="flyto" id="London">London</a>.</p>
        </section>
        <section>
            <h3><a href="#" class="flyto" id="South Africa">South Africa</a></h3>
            <p>Such trend in South Africa is very similar to the UK. Both weekdays and weekends show the highest number of check-ins on 8 am. It also presents a trend that the number of check-ins is fluctuating on weekends and fewer than in other countries. <a href="#" class="flyto" id="Johannesburg">Johannesburg</a>, as the largest city and economic and cultural centre in South Africa, is a representative.</p>
        </section>
        <section>
            <h3><a href="#" class="flyto" id="Australia">Australia</a></h3>
            <p>Australia shows a similar trend on weekdays but a slightly different trend from the previous two cities on weekends. Take <a href="#" class="flyto" id="Sydney">Sydney</a> for example, it has more check-ins than other countries on weekends. The numbers begin to increase dramatically after 4 am and decrease after 7 am on weekends. And the largest number of check-ins is at 8 am on weekdays and 7 am on weekends.</p>
        </section>
        <section>
            <h3><a href="#" class="flyto" id="Singapore">Singapore</a></h3>
            <p>A different trend is again showing up in Singapore. Unlike most countries, weekday check-ins are not continue to fall after 11 am, but are increased until 5 pm. Moreover, the number of weekend check-ins is highest at 4 pm and also more active than most other countries. Another obvious manifestation is the check-in place in Singapore Changi Airport, where people check-in in office at different times of the day.</p>
            </section>
        <section>
            <h3><a href="#" class="flyto" id="US">US</a></h3>
            <p>As can be seen from the map, the United States has a lot of check-ins number. Through looking at <a href="#" class="flyto" id="New York">New York City</a> on weekdays, the number of check-ins has a similar trend with London. For the weekends, it shows a steady trend from 8 am to 7 pm.</p>
        </section>
        <section>
            <h3><a href="#" class="flyto" id="Brazil">Brazil</a></h3>
            <p>Brazil shows fewer number of check-ins than other countries at 11am on weekdays. After 8 am on weekends, the number of check-ins is gradually declined. Overall, it is still similar to most countries. A representative example is <a href="#" class="flyto" id="Sao Paulo">SÃ£o Paulo</a>, the largest city in Brazil.</p>
        </section>
    </div>
    
    <!--Weekday Comparison and Weedend Comparison Button-->
    <button id="button1">UK</button>
    <button id="button2">South Africa</button>
    <button id="button3">Australia</button>
    <button id="button4">Singapore</button>
    <button id="button5">US</button>
    <button id="button6">Brazil</button>

    <!--Graph-->
    <div id="graph1">
        <h3>Number of Office Check-ins by Hour of the Day - UK</h3>
        <div id="linechart"><canvas id="chart1"></canvas></div>
    </div>
    <div id="graph2">
        <h3>Number of Office Check-ins by Hour of the Day - South Africa</h3>
        <div id="linechart"><canvas id="chart2"></canvas></div>
    </div>
    <div id="graph3">
        <h3>Number of Office Check-ins by Hour of the Day - Australia</h3>
        <div id="linechart"><canvas id="chart3"></canvas></div>
    </div>
    <div id="graph4">
        <h3>Number of Office Check-ins by Hour of the Day - Singapore</h3>
        <div id="linechart"><canvas id="chart4"></canvas></div>
    </div>
    <div id="graph5">
        <h3>Number of Office Check-ins by Hour of the Day - US</h3>
        <div id="linechart"><canvas id="chart5"></canvas></div>
    </div>
    <div id="graph6">
        <h3>Number of Office Check-ins by Hour of the Day - Brazil</h3>
        <div id="linechart"><canvas id="chart6"></canvas></div>
    </div>

<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiY2FzYTAwMDMiLCJhIjoiY2p0enluaHh0MGJ4YjQxbWUzdmh6dWEwNSJ9.mbgxLvW6YvE4kxM5w6686g';
    var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/casa0003/cjv9ti3od2klt1fqjvey69t61',
        center: [-0.115,51.485],
        zoom: 9.5
    });
    // Create an array of the unixtime after data cleaning
    var value_weekday = [1325440800.0, 1325444400.0, 1325426400.0, 1325422800.0, 1325433600.0, 1325430000.0, 1325448000.0, 1325451600.0, 1325415600.0, 1325419200.0, 1325437200.0, 1325455200.0, 1325376000.0, 1325458800.0, 1325386800.0, 1325408400.0, 1325412000.0, 1325404800.0, 1325379600.0, 1325401200.0, 1325383200.0, 1325390400.0, 1325397600.0, 1325394000.0];
    value_weekday.sort();
    
    var value_weekend = [1325473200.0, 1325509200.0, 1325534400.0, 1325523600.0, 1325520000.0, 1325466000.0, 1325476800.0, 1325512800.0, 1325505600.0, 1325541600.0, 1325469600.0, 1325462400.0, 1325502000.0, 1325530800.0, 1325516400.0, 1325538000.0, 1325527200.0, 1325545200.0, 1325498400.0, 1325480400.0, 1325484000.0, 1325491200.0, 1325487600.0, 1325494800.0];
    value_weekend.sort();
    
    map.on('load', function() {
        
        // Add weekday heatmap layer
        map.addLayer({
            'id': 'Weekday',
            'type': 'heatmap',
            source: {
                type: 'vector',
                url: 'mapbox://casa0003.dci1e4ev'
            },
            // Filter by unixtime
            'filter': ['==', ['number', ['get', 'unix']], value_weekday[0]],
            'source-layer': 'weekday-7h6r9n',    
            'maxzoom': 13,
            'layout': {
            'visibility': 'visible'
            },
            paint: {
                'heatmap-weight': {
                    type: 'exponential',
                    stops: [
                        [1, 0],
                        [6, 1]
                    ]
                },
                // Increase intensity as zoom level increases
                // Heatmap-intensity is a multiplier on top of heatmap-weight
                'heatmap-intensity': {
                    stops: [
                        [3, 1],
                        [13, 2]
                    ]
                },
                // Assign color values be applied to points depending on their density
                // Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
                'heatmap-color': [
                    'interpolate',
                    ['linear'],
                    ['heatmap-density'],
                    0, "rgba(33,102,172,0)",
                    0.2, "rgb(103,169,207)",
                    0.4, "rgb(209,229,240)",
                    0.6, "rgb(253,219,199)",
                    0.8, "rgb(239,138,98)",
                    1, "rgb(178,24,43)"
                ],
                // Adjust the heatmap radius by zoom level
                // The radius of influence for each data point, in pixels
                'heatmap-radius': {
                    stops: [
                        [5, 5],
                        [13, 20]
                    ]
                },
                // Decrease opacity to transition into the circle layer by zoom level
                'heatmap-opacity': {
                    default: 1,
                    stops: [
                        [12, 1],
                        [13, 0.5]
                    ]
                },
            }
        }, 'waterway-label');
        
        // Add weekend heatmap layer
        map.addLayer({
            'id': 'Weekend',
            'type': 'heatmap',
            source: {
                type: 'vector',
                url: 'mapbox://casa0003.4giw89ci'
            },
            'filter': ['==', ['number', ['get', 'unix']], value_weekend[0]],
            'source-layer': 'weekend-6k1ei2',    
            'maxzoom': 13,
            // Starting view will not show weekend layer
            'layout': {
                'visibility': 'none'
            },
            paint: {
                'heatmap-weight': {
                    type: 'exponential',
                    stops: [
                        [1, 0],
                        [6, 1]
                    ]
                },
                'heatmap-intensity': {
                    stops: [
                        [3, 1],
                        [13, 2]
                    ]
                },
                'heatmap-color': [
                    'interpolate',
                    ['linear'],
                    ['heatmap-density'],
                    0, "rgba(33,102,172,0)",
                    0.2, "rgb(103,169,207)",
                    0.4, "rgb(209,229,240)",
                    0.6, "rgb(253,219,199)",
                    0.8, "rgb(239,138,98)",
                    1, "rgb(178,24,43)"
                ],
                'heatmap-radius': {
                    stops: [
                        [5, 5],
                        [13, 20]
                    ]
                },
                'heatmap-opacity': {
                    default: 1,
                    stops: [
                        [12, 1],
                        [13, 0.5]
                    ]
                },
            }
        }, 'waterway-label'); 
        
        // Add weekday circle layer here 
        map.addLayer({
            'id': 'weekday-point',
            'type': 'circle',
            source: {
                type: 'vector',
                url: 'mapbox://casa0003.dci1e4ev'
            },
            'filter': ['==', ['number', ['get', 'unix']], value_weekday[0]],
            'source-layer': 'weekday-7h6r9n', 
            'minzoom': 13,
            paint: {
                // Increase the radius of the circle as the zoom level
                'circle-radius': {
                    type: 'exponential',
                    stops: [
                        [14, 5],
                        [16, 10],
                        [20, 20],
                        [22, 30],
                    ]
                },
                'circle-color': {
                    type: 'exponential',
                    stops: [
                        [13, 'rgb(236,222,239)'],
                        [15, 'rgb(208,209,230)'],
                        [17, 'rgb(166,189,219)'],
                        [19, 'rgb(103,169,207)'],
                    ]
                },
                'circle-stroke-color': 'white',
                'circle-stroke-width': 1,
                'circle-opacity': 0.9
            }
        }, 'waterway-label');
    
        // Add weekend circle layer here 
        map.addLayer({
            'id': 'weekend-point',
            'type': 'circle',
            source: {
                type: 'vector',
                url: 'mapbox://casa0003.4giw89ci'
            },
            'filter': ['==', ['number', ['get', 'unix']], value_weekend[0]],
            'source-layer': 'weekend-6k1ei2', 
            'minzoom': 13,
            // Starting view will not show weekend layer
            'layout': {
                'visibility': 'none'
            },
            paint: {
                // Increase the radius of the circle as the zoom level
                'circle-radius': {
                    type: 'exponential',
                    stops: [
                        [14, 5],
                        [16, 10],
                        [20, 20],
                        [22, 30],
                    ]
                },
                'circle-color': {
                    type: 'exponential',
                    stops: [
                        [13, 'rgb(236,222,239)'],
                        [15, 'rgb(208,209,230)'],
                        [17, 'rgb(166,189,219)'],
                        [19, 'rgb(103,169,207)'],
                    ]
                },
                'circle-stroke-color': 'white',
                'circle-stroke-width': 1,
                'circle-opacity': 0.9
            }
        }, 'waterway-label');   
    
        // Add the "fly to" function
        var x = document.getElementsByClassName('flyto');
        var i;
        for (i = 0; i < x.length; i++) {
            x[i].addEventListener('click', function(e) {
                var lat,long,zoom, pitch, bearing;
                switch(e.target.id) {
                    case "UK": long=-1.122; lat=54.263; zoom=5.27; pitch=0; bearing=0;break;    
                    case "London": long=-0.115; lat=51.485; zoom=9.5; pitch=0; bearing=0;break;
					case "South Africa": long=25.900; lat=-28.582; zoom=5.20; pitch=0; bearing=0;break;
                    case "Johannesburg": long=28.03; lat=-26.155; zoom=10.7; pitch=0; bearing=0;break;
					case "Australia": long=138.159; lat=-26.917; zoom=4.2; pitch=0; bearing=0;break;
					case "Sydney": long=151.000; lat=-33.852; zoom=10.1; pitch=0; bearing=0;break;
                    case "Singapore": long=103.840; lat=1.315; zoom=11.99; pitch=70; bearing=5;break;
                    case "US": long=-95.597; lat=39.087; zoom=4.05; pitch=0; bearing=0;break;
                    case "New York": long=-74.01; lat=40.739; zoom=10.5; pitch=60; bearing=340;break;
                    case "Brazil": long=-48.450; lat=-16.100; zoom=4.11; pitch=0; bearing=0;break;
                    case "Sao Paulo": long=-46.631; lat=-23.589; zoom=10.75; pitch=0; bearing=0;break;
				}
                map.flyTo({
                    center: [long,lat],
					zoom: zoom,
					speed: 0.5,
                    pitch: pitch,
                    bearing: bearing
					});
            });
        }
    });
    
    // Create "Weekday" and "Weekend" button to show or hide both heatmap and point (circle layer)
    // Reference: https://github.com/london-rhythms/london-rhythms.github.io
    var toggleableLayerIds = ['Weekday', 'Weekend'];
    for (var i = 0; i < toggleableLayerIds.length; i++) {
        var id = toggleableLayerIds[i];
        var link = document.createElement('a');
        link.id = id;
        link.href = '#'+id;
        link.className = '';
        link.textContent = id;
        
        $("#Weekday").attr("class", "active");
        console.log(document.getElementById("Weekday"));
        link.onclick = function (e) {
            var clickedLayer = this.textContent;
            e.preventDefault();
            e.stopPropagation();
            
            // When click "Weekend" then only show weekend heatmap and point
            if (this.className === '' && this.id === 'Weekend') {
                map.setLayoutProperty('Weekend', 'visibility', 'visible');
                map.setLayoutProperty('weekend-point', 'visibility', 'visible');
                map.setLayoutProperty('Weekday', 'visibility', 'none'); 
                map.setLayoutProperty('weekday-point', 'visibility', 'none'); 
                
                this.className = 'active';
                var Weekday = document.getElementById('Weekday');
                Weekday.className = '';              
            } 
            
            // When "Weekend" already showed, then click it again will close weekend heatmap and point
            else if (this.className === 'active' && this.id === 'Weekend') {
                map.setLayoutProperty('Weekend', 'visibility', 'none');
                map.setLayoutProperty('weekend-point', 'visibility', 'none');
                this.className = '';
            }
            
            // When click "Weekday" then only show weekday heatmap and point
            else if (this.className === '' && this.id === 'Weekday') {
                map.setLayoutProperty('Weekday', 'visibility', 'visible');
                map.setLayoutProperty('weekday-point', 'visibility', 'visible');
                map.setLayoutProperty('Weekend', 'visibility', 'none');
                map.setLayoutProperty('weekend-point', 'visibility', 'none'); 
                
                this.className = 'active';
                var Weekend = document.getElementById('Weekend');
                Weekend.className = '';      
            }
        
            // When "Weekday" already showed, then click it again will close weekday heatmap and point
            else if (this.className === 'active' && this.id === 'Weekday') {
                map.setLayoutProperty('Weekday', 'visibility', 'none');
                map.setLayoutProperty('weekday-point', 'visibility', 'none');
                this.className = '';
            }
        }
        var layers = document.getElementById('menu');
        layers.appendChild(link);
    }
    
    // Set the slider and play pause function
    // Reference: https://github.com/london-rhythms/london-rhythms.github.io
    var interval;
    
    // "+" button
    $('#forward').click(function () {
        var index = $('.range-slider').val();
        index++;
        index = index > 23 ? 0 : index;
        $('.range-slider').val(index);
        // Because it use the same time slider and both have 24-hour data, just choose one of the unixtime values
        var date_value = value_weekday[index];
        // Multiply by 1000 otherwise no change with time
        var d = new Date(date_value*1000);
        // "Minutes < 1" includes all of the data because minutes start with "0"
        if (d.getMinutes() < 1) {
            var time = d.getHours() + ':' + "0" + d.getMinutes();
        }
        $("#time").html(time);
        // Filter by unixtime
        map.setFilter('Weekday', ['==', ['number', ['get', 'unix']], value_weekday[index]]);
        map.setFilter('weekday-point', ['==', ['number', ['get', 'unix']], value_weekday[index]]);
        map.setFilter('Weekend', ['==', ['number', ['get', 'unix']], value_weekend[index]]);
        map.setFilter('weekend-point', ['==', ['number', ['get', 'unix']], value_weekend[index]]);
    });
    
    // "-" button
    $('#backward').click(function () {
        var index = $('.range-slider').val();
        index--
        index = index < 0 ? 23 : index;
        $('.range-slider').val(index);
        var date_value = value_weekday[index];
        // Multiply by 1000
        var d = new Date(date_value*1000);
        if (d.getMinutes() < 1) {
            var time = d.getHours() + ':' + "0" + d.getMinutes();
        }
        $("#time").html(time); 
        map.setFilter('Weekday', ['==', ['number', ['get', 'unix']], value_weekday[index]]);
        map.setFilter('weekday-point', ['==', ['number', ['get', 'unix']], value_weekday[index]]);
        map.setFilter('Weekend', ['==', ['number', ['get', 'unix']], value_weekend[index]]);
        map.setFilter('weekend-point', ['==', ['number', ['get', 'unix']], value_weekend[index]]);
    });
    
    // "Play" button
    $('#play').click(function(){
        interval=setInterval(function (){
            $("#forward").trigger('click');
            // Play button colour
            var play = document.getElementById("play");
            play.setAttribute("style", "background-color: #3198ff");
            // Pause button colour
            var stop = document.getElementById("stop");
            stop.setAttribute("style", "background-color: black");
            // Rate of the speed of slider 
        },1000);
    });
    
    // "Pause" button
    $("#stop").click(function(){
        // Pause button colour
        var stop = document.getElementById("stop");
        stop.setAttribute("style", "background-color: #3198ff");
        // Play button colour
        var play = document.getElementById("play");
        play.setAttribute("style", "background-color: black");
        clearInterval(interval);
    });
    
    document.getElementById('input').addEventListener('input', function(e) {
    // Get value of the slider when changing the slider manually 
        var index = parseInt(e.target.value);
        map.setFilter('Weekday', ['==', ['number', ['get', 'unix']], value_weekday[index]]);
        map.setFilter('weekday-point', ['==', ['number', ['get', 'unix']], value_weekday[index]]);
        map.setFilter('Weekend', ['==', ['number', ['get', 'unix']], value_weekend[index]]);
        map.setFilter('weekend-point', ['==', ['number', ['get', 'unix']], value_weekend[index]]);
    });
    var index = $('.range-slider').val();
    var input = document.getElementById('input'),
        output = document.getElementById('output');
    input.oninput = function(){
        var date_value = value_weekday[this.value];
        var d = new Date(date_value*1000);
        if (d.getMinutes() < 1) {
        var time = d.getHours() + ':' + "0"+ d.getMinutes();
    }
        var index = $('.range-slider').val();
        $("#time").html(time);  
    };       
  
    // Create an event listener that adds the popup when the user puts their cursor over the circles
    // Weekday-point
    var mypopup = new mapboxgl.Popup();
    map.on('mouseover', 'weekday-point', function (e) {
        mypopup
            .setLngLat(e.features[0].geometry.coordinates)
            .setHTML("Time: "+ e.features[0].properties.datetime)
            .addTo(map);
    });
    // Change the cursor to a pointer when the mouse is over the stations layer.
    map.on('mouseenter', 'weekday-point', function () {
        map.getCanvas().style.cursor = 'pointer';
    });
    // Change it back to a pointer when it leaves and remove the popup window.
    map.on('mouseleave', 'weekday-point', function () {
        map.getCanvas().style.cursor = '';
        mypopup.remove();
    });
    
    // Event listener that adds the popup when the user puts their cursor over the circles - for weekend-point
    var mypopup = new mapboxgl.Popup();
    map.on('mouseover', 'weekend-point', function (e) {
        mypopup
            .setLngLat(e.features[0].geometry.coordinates)
            .setHTML("Time: "+ e.features[0].properties.datetime)
            .addTo(map);
    });
    map.on('mouseenter', 'weekend-point', function () {
        map.getCanvas().style.cursor = 'pointer';
    });
    map.on('mouseleave', 'weekend-point', function () {
        map.getCanvas().style.cursor = '';
        mypopup.remove();
    });
    
    // Chart1 - UK
    new Chart(document.getElementById("chart1"), {
        type: 'line',
        data: {
            labels: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23'],
            datasets: [{
                data: [23, 14, 6, 11, 28, 34, 279, 1195, 2779, 2659, 1571, 1066, 954, 812, 667, 480, 392, 396, 312, 167, 81, 53, 45, 48],
                label: "weekday count",
                borderColor: "#3e95cd",
                borderWidth: 1.5,
                pointRadius: 1.5,
                backgroundColor: "#3e95cd",
                fill: false
            }, {
                data: [7, 5, 3, 9, 7, 11, 21, 44, 53, 66, 73, 69, 54, 44, 41, 39, 34, 43, 27, 23, 27, 16, 18, 15],
                label: "weekend count",
                borderColor: "#c45850",
                borderWidth: 1.5,
                pointRadius: 1.5,
                pointStyle: 'triangle',
                backgroundColor: "#c45850",
                fill: false
            }]
        },
        options: {
            legend: {
                position: 'top',
                labels: {
                    boxWidth: 10,
                    fontColor: '#fff'
                }
            },
            scales: {
                xAxes: [{
                    display: true,
                ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                },
                gridLines: {
                    color: 'rgba(255,255,255,0.2)'
                },
                }],
                yAxes: [{
                    display: true,
                    ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                    },
                    gridLines: {
                        color: 'rgba(255,255,255,0.2)'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Counts',
                        fontSize: 12,
                        fontColor: '#fff'
                    }
                }]
            }
        }
    });
    //Click "UK" to show the graph layer
    var link = document.getElementById('button1');
    link.onclick = function (e) {
        //Show and hide graph through changing the visibility
        var y = document.getElementById("graph1");
        if (y.style.display === "none" || y.style.display === "") {
            y.style.display = "block";
        } else {
            y.style.display = "none";
        }
    };
  
    // Chart2 - South Africa
    new Chart(document.getElementById("chart2"), {
        type: 'line',
        data: {
            labels: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23'],
            datasets: [{
                data: [2, 1, 2, 1, 3, 49, 159, 471, 585, 450, 316, 230, 180, 137, 105, 84, 64, 40, 31, 10, 7, 4, 2, 0],
                label: "weekday count",
                borderColor: "#3e95cd",
                borderWidth: 1.5,
                pointRadius: 1.5,
                backgroundColor: "#3e95cd",
                fill: false
            }, {
                data: [0, 2, 0, 0, 0, 3, 3, 5, 16, 5, 11, 5, 8, 4, 2, 10, 4, 5, 2, 6, 6, 0, 1, 0],
                label: "weekend count",
                borderColor: "#c45850",
                borderWidth: 1.5,
                pointRadius: 1.5,
                pointStyle: 'triangle',
                backgroundColor: "#c45850",
                fill: false
            }]
        },
        options: {
            legend: {
                position: 'top',
                labels: {
                    boxWidth: 10,
                    fontColor: '#fff'
                }
            },
            scales: {
                xAxes: [{
                    display: true,
                ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                },
                gridLines: {
                    color: 'rgba(255,255,255,0.2)'
                },
                }],
                yAxes: [{
                    display: true,
                    ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                    },
                    gridLines: {
                        color: 'rgba(255,255,255,0.2)'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Counts',
                        fontSize: 12,
                        fontColor: '#fff'
                    }
                }]
            }
        }
    });
    //Click "South Africa" to show the graph layer
    var link = document.getElementById('button2');
    link.onclick = function (e) {
        //Show and hide graph through changing the visibility
        var y = document.getElementById("graph2");
        if (y.style.display === "none" || y.style.display === "") {
            y.style.display = "block";
        } else {
            y.style.display = "none";
        }
    };
    
     // Chart3 - Australia
    new Chart(document.getElementById("chart3"), {
        type: 'line',
        data: {
            labels: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23'],
            datasets: [{
                data: [3, 3, 4, 4, 16, 53, 243, 482, 593, 370, 303, 237, 222, 218, 216, 141, 170, 132, 82, 60, 32, 24, 12, 15],
                label: "weekday count",
                borderColor: "#3e95cd",
                borderWidth: 1.5,
                pointRadius: 1.5,
                backgroundColor: "#3e95cd",
                fill: false
            }, {
                data: [2, 1, 2, 3, 6, 29, 41, 154, 145, 65, 17, 20, 21, 20, 32, 22, 17, 12, 8, 11, 6, 12, 13, 1],
                label: "weekend count",
                borderColor: "#c45850",
                borderWidth: 1.5,
                pointRadius: 1.5,
                pointStyle: 'triangle',
                backgroundColor: "#c45850",
                fill: false
            }]
        },
        options: {
            legend: {
                position: 'top',
                labels: {
                    boxWidth: 10,
                    fontColor: '#fff'
                }
            },
            scales: {
                xAxes: [{
                    display: true,
                ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                },
                gridLines: {
                    color: 'rgba(255,255,255,0.2)'
                },
                }],
                yAxes: [{
                    display: true,
                    ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                    },
                    gridLines: {
                        color: 'rgba(255,255,255,0.2)'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Counts',
                        fontSize: 12,
                        fontColor: '#fff'
                    }
                }]
            }
        }
    });
    //Click "Australia" to show the graph layer
    var link = document.getElementById('button3');
    link.onclick = function (e) {
        //Show and hide graph through changing the visibility
        var y = document.getElementById("graph3");
        if (y.style.display === "none" || y.style.display === "") {
            y.style.display = "block";
        } else {
            y.style.display = "none";
        }
    };
    
     // Chart4 - Singapore
    new Chart(document.getElementById("chart4"), {
        type: 'line',
        data: {
            labels: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23'],
            datasets: [{
                data: [34, 14, 11, 1, 6, 16, 69, 268, 709, 489, 303, 275, 315, 399, 388, 385, 443, 455, 253, 174, 109, 61, 46, 43],
                label: "weekday count",
                borderColor: "#3e95cd",
                borderWidth: 1.5,
                pointRadius: 1.5,
                backgroundColor: "#3e95cd",
                fill: false
            }, {
                data: [9, 2, 3, 1, 4, 8, 27, 51, 60, 41, 51, 47, 54, 65, 57, 49, 67, 29, 35, 33, 24, 15, 11, 11],
                label: "weekend count",
                borderColor: "#c45850",
                borderWidth: 1.5,
                pointRadius: 1.5,
                pointStyle: 'triangle',
                backgroundColor: "#c45850",
                fill: false
            }]
        },
        options: {
            legend: {
                position: 'top',
                labels: {
                    boxWidth: 10,
                    fontColor: '#fff'
                }
            },
            scales: {
                xAxes: [{
                    display: true,
                ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                },
                gridLines: {
                    color: 'rgba(255,255,255,0.2)'
                },
                }],
                yAxes: [{
                    display: true,
                    ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                    },
                    gridLines: {
                        color: 'rgba(255,255,255,0.2)'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Counts',
                        fontSize: 12,
                        fontColor: '#fff'
                    }
                }]
            }
        }
    });
    //Click "Singapore" to show the graph layer
    var link = document.getElementById('button4');
    link.onclick = function (e) {
        //Show and hide graph through changing the visibility
        var y = document.getElementById("graph4");
        if (y.style.display === "none" || y.style.display === "") {
            y.style.display = "block";
        } else {
            y.style.display = "none";
        }
    };
    
     // Chart5 - US
    new Chart(document.getElementById("chart5"), {
        type: 'line',
        data: {
            labels: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23'],
            datasets: [{
                data: [360, 325, 483, 482, 705, 1650, 4796, 11731, 19652, 17137, 11510, 9106, 8437, 7542, 6421, 5183, 4258, 3661, 3206, 2220, 1300, 904, 751, 488],
                label: "weekday count",
                borderColor: "#3e95cd",
                borderWidth: 1.5,
                pointRadius: 1.5,
                backgroundColor: "#3e95cd",
                fill: false
            }, {
                data: [191, 125, 135, 139, 103, 143, 221, 370, 522, 552, 506, 511, 554, 561, 548, 576, 469, 517, 427, 543, 430, 334, 225, 240],
                label: "weekend count",
                borderColor: "#c45850",
                borderWidth: 1.5,
                pointRadius: 1.5,
                pointStyle: 'triangle',
                backgroundColor: "#c45850",
                fill: false
            }]
        },
        options: {
            legend: {
                position: 'top',
                labels: {
                    boxWidth: 10,
                    fontColor: '#fff'
                }
            },
            scales: {
                xAxes: [{
                    display: true,
                ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                },
                gridLines: {
                    color: 'rgba(255,255,255,0.2)'
                },
                }],
                yAxes: [{
                    display: true,
                    ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                    },
                    gridLines: {
                        color: 'rgba(255,255,255,0.2)'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Counts',
                        fontSize: 12,
                        fontColor: '#fff'
                    }
                }]
            }
        }
    });
    //Click "US" to show the graph layer
    var link = document.getElementById('button5');
    link.onclick = function (e) {
        //Show and hide graph through changing the visibility
        var y = document.getElementById("graph5");
        if (y.style.display === "none" || y.style.display === "") {
            y.style.display = "block";
        } else {
            y.style.display = "none";
        }
    };
    
     // Chart6 - Brazil
    new Chart(document.getElementById("chart6"), {
        type: 'line',
        data: {
            labels: ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23'],
            datasets: [{
                data: [160, 118, 69, 93, 411, 1918, 10379, 26957, 29225, 18667, 10242, 7519, 8116, 9474, 7394, 5233, 4102, 3424, 2365, 1652, 828, 527, 425, 277],
                label: "weekday count",
                borderColor: "#3e95cd",
                borderWidth: 1.5,
                pointRadius: 1.5,
                backgroundColor: "#3e95cd",
                fill: false
            }, {
                data: [117, 72, 42, 54, 67, 163, 364, 643, 737, 670, 524, 387, 345, 360, 367, 286, 323, 300, 285, 253, 231, 238, 211, 145],
                label: "weekend count",
                borderColor: "#c45850",
                borderWidth: 1.5,
                pointRadius: 1.5,
                pointStyle: 'triangle',
                backgroundColor: "#c45850",
                fill: false
            }]
        },
        options: {
            legend: {
                position: 'top',
                labels: {
                    boxWidth: 10,
                    fontColor: '#fff'
                }
            },
            scales: {
                xAxes: [{
                    display: true,
                ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                },
                gridLines: {
                    color: 'rgba(255,255,255,0.2)'
                },
                }],
                yAxes: [{
                    display: true,
                    ticks: {
                    fontSize: 10,
                    fontColor: '#fff'
                    },
                    gridLines: {
                        color: 'rgba(255,255,255,0.2)'
                    },
                    scaleLabel: {
                        display: true,
                        labelString: 'Counts',
                        fontSize: 12,
                        fontColor: '#fff'
                    }
                }]
            }
        }
    });
    //Click "Brazil" to show the graph layer
    var link = document.getElementById('button6');
    link.onclick = function (e) {
        //Show and hide graph through changing the visibility
        var y = document.getElementById("graph6");
        if (y.style.display === "none" || y.style.display === "") {
            y.style.display = "block";
        } else {
            y.style.display = "none";
        }
    };

  </script>
</body>
</html>
